<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>Velocity of Ecological System Trajectory</title>
    <meta charset="utf-8" />
    <meta name="author" content="N.B. Price, A.J. Tyre, C.R. Allen, D.G. Angeler, &amp; D. Twidwell" />
    <link rel="stylesheet" href="myFonts.css" type="text/css" />
    <link rel="stylesheet" href="myTheme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Velocity of Ecological System Trajectory
## <strong>A new method for dimension reduction and ecological regime shift detection</strong> </br> </br> <strong>Jessica L. Burnett</strong>
### N.B. Price, A.J. Tyre, C.R. Allen, D.G. Angeler, &amp; D. Twidwell
### 2019.04.07

---





# Ecosystems are Complex &lt;!-- list of characteristics --&gt;  
###*(and complicated)*

#### - high dimensional    
#### - many ( `\(\infty\)` ?) interactions  
#### - non-linear  
#### - non-ergodic (open)   
#### - dynamic  

???
Ecosystems are complex; that is, they are non-ergodic,  high-dimensional and usually non-linear. 


--

#### - **difficult to model mathematically**     

???
Anyone studying dynamical systems or studying ecological systems probabl understands that building mathewmatical models to accurately and usefully describe empirical systems is difficult. 

Especially as we move beyonbd just a handful of state  variables.
---

# The Holy Grail of Ecology &lt;!-- ...is prediction --&gt;
&lt;br&gt;  
&lt;br&gt;
# **forecasting change in time to prevent or mitigate undesirable consequences**
&lt;br&gt;


???

- **Despite this complexity** of ecological systems, we as ecologists strive to **make predictions

- One **increasingly active line of research** in ecology is "regime shifts"

--

# "regime shifts"


---

# Ecological Regime Shifts 

## **what?**  a persistent change in the structure or functioning of a system 
&lt;/br&gt;  

???

- A **persistent change in the sturcture or functioning of a system**


--

## **how?** loss of negative feedback(s) maintaining the system
&lt;br&gt;

???

- Regime shifts occur, via a number of pathways, when a system **loses the negative feedback(s) maintaining** the system in its current state

- Again, *goal* is to predict in time to prevent something bad from happening. Pipe dream? Probably...


--

## **goal?** predict in time to prevent  


---

# Methods for Detecting Regime Shifts

### `\(&gt; 70\)` (!) methods proposed in literature
### `\(10\)` suitable for multivariable data
### few explicitly handle noisy data
### few handle irregular sampling

???

- Briefly, I'll mention that the number of **methods proposed** for as regime shift detetion methods is **staggering**. 
- Because many of these methods come from the climatological and marine sciences,where we're looking for abrupt shifts in say Arctic Cod,  about 1/3 are suitabnle for multivariable data
- And surprisingly, none explicitly handle noisy data

---

# Regime Shifts Detection Methods
  ###   Rising Variance/Critical Slowing Down
  ###   Variance Index (max eigenvalue of covariance matrix)
  ###   Principal Coordinates Analysis
  
--
  
  ###   **Fisher Information** 
  
--

  ### **Velocity**, `\(v\)`

???

- A few of the methods capable of handling multivariable data variance, PCA and an obscure method called, Fisher Information. 

- And its from FI where we derived a new method that I am described today, called **Velocity**

---

# Toy System
&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/exData.png" width="55%" style="display: block; margin: auto;" /&gt;

$$ x ~ normal(\mu = 25, \sigma = 5) \textrm{ for t } &gt; 50$$
`$$x ~ normal(\mu =100, \sigma = 5) \textrm{ for t } \geq 50$$`
???
So the calculations for **velocity** are quite simple, and I am goign to step through the few steps first using this simple 2-variable system, where I induced a change in mean of state variables at time t = 50. 

---

# Velocity, `\(\frac{\Delta s}{\Delta t}\)` 
#### the linear speed of a system's trajectory (e.g., in phase space)

.pull-left[
&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/exData.png" width="100%" style="display: block; margin: auto;" /&gt;
]
.pull-right[
&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/phaseplot.png" width="150%" style="display: block; margin: auto;" /&gt;
]

???

So, our method, velocity, is basically the linear speed of a system's trajectory as it moves through phase space. 

---

# Step 1: Calculate ** `\(\Delta s\)` **, 'distance travelled'

## `$$s = \textrm{system state}$$`

--
&lt;/br&gt; 


## `$$\Delta s_i = \sqrt{\sum_{j=1}^{n} (x_{i,j} -x_{i-1, j})^2}$$` 




---

# Step 2: Calculate ** `\(s\)` **, **cumulative** distance travelled

### `$$\Delta s_i = \sqrt{\sum_{j=1}^{n} (x_{i,j} -x_{i-1, j})^2}$$`

## `$$s_k =  \sum_{i=2}^{k}\Delta{s_i}$$`
### `$$2\leq k \leq n$$`

---

# Step 3: Calculate ** `\(v\)` ** , the linear speed of ** `\(s\)` **
#### `$$v =  \frac{\Delta s}{\Delta t}$$`  

&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/dsdtplot.png" width="55%" style="display: block; margin: auto;" /&gt;

---

&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/velocSysEx1-1.png" width="60%" style="display: block; margin: auto;" /&gt;
&lt;/br&gt;
&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/velocSysEx2-1.png" width="60%" style="display: block; margin: auto;" /&gt;

---
# Potential Limitations of `\(v\)`
### `\(v\)` increases with increasing effect size

&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/simVplot1.png" width="80%" /&gt;

???
- Going back to our toy system, the velocity increases as our total change in X_i increases 

---
# Potential Limitations of `\(v\)`
### `\(v\)` increases with increasing effect size

&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/simVplot2.png" width="80%" /&gt;

???
- But does not necessarily improve as an indicator

---


# Empirical System: Paleodiatom &lt;!--1--&gt;

&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/paleoData.png" width="80%" /&gt;
 
Data published in Spanbauer *et al.* 2014. Prolonged Instability Prior to a Regime Shift. PLoS One
  
???

We also tested the method on paleodiatom data dating back about 8,000 years before present.
Notice here there is a high species turnover
---
# Empirical System: Paleodiatom &lt;!--2--&gt;

&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/fipaleo.png" width="100%" /&gt;


???

We also tested the method on paleodiatom data dating back about 8,000 years before present.
Notice here there is a high species turnover
---


# Empirical System: Paleodiatom &lt;!--3 Results--&gt;
&lt;!-- ## Distance travelled ** `\(s\)` ** &amp; Velocity ** `\(v\)` ** identify these turnover events --&gt;

&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/paleoVelocity.png" width="100%" /&gt;

???
S and V clearly identify these turnover events, but V is somewhat noisy.

---

# Smoothing Noisy Data Before Calculating ** `\(v\)` ** 

#### Total Variation Regularized Numerical Differentiation

&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/paleoV.png" width="90%" /&gt;

???
Here we have used regularized differentiation to smooth out the original data, and which in turn smooths out the velocity. 

---

# `\(v\)` Identifies Potential Periodicities in Certain Regimes
&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/paleoV2.png" width="90%" /&gt;

???
- Additioanlly, we found it interesting that velocity also identifies interesting dynamics within the system regimes. Note the periodicities in regime 1 and 2. 
- These periodicities were not discussed in origianl examinations of this data.
---

# Impacts of Changes in Data Quality on `\(s\)` and `\(v\)`  &lt;!-- 1 --&gt;
&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/distance_95PI_s_observations.png" width="90%" /&gt;

---
# Impacts of Changes in Data Quality on `\(s\)` and `\(v\)`  &lt;!-- 2 --&gt;
&lt;img src="/Users/jessicaburnett/Documents/GitHub/velocity_presentations/awm_april2019/figures/distance_dsdt_observations.png" width="90%" /&gt;

---

# Conclusions 

### Reduction of high dimensional data
### Capable of handling noisy data
### Is not sensitive to data quality issues common in ecology
### Best when mean &gt; variance
### Identifies regime shifts known *a priori* 

---


# Next Steps
### Numerical identification of change point in `\(v\)`  
### Compare to distance-based metrics (feedback?)
### Compare to ordination techniques
### Predictive capacity

???
- One of the primary motivations for this project was to identify an objective, intuitive, and easy-to-calculate method for identifying ecological regime shifts


---
# Related Software
### R packages (dev versions):
####  `trashbirdecology/distanceTravelled` (calculate `\(s\)` and `\(v\)`)
####  `trashbirdecology/regimeDetectionMeasures` (calculate multiple regime detection metrics)
####  `trashbirdecology/bbsRDM` (application to spatial data)
####  `natbprice/tvdiff` (regularized differentiation)
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
